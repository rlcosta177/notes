----------------------------------------- Passwords & Contas --------------------------------
eMail pass:
Super@Passw0rd |ou| Passw0rd

aws login:
rodrigolimacosta@enta.pt

wifi pass:
ENTAWiFi

adm pass:
&9va@ENTA

credenciais remmina:
ec2-user
Passw0rd

--------------------------------------------- Furutre Studies(Udemy&Stuff) --------------------------
https://www.youtube.com/watch?v=tZbayqSJISU -> show interfaces input errors possible causes

_______________________________________________________________________________________________________________________________________________

1041 -> Layer2 Etherchannel -> DONE
1043 -> static routes IPv4&IPv6 -> DONE
1052 -> NAT, NTP, DHCP and SSH -> DOING
1054 -> vlan config & cdp -> DONE
1058 -> IPv4&IPv6 subnetting and assign the ips to intefaces
1059 -> vlan configuration
1060 -> access lists
1061 -> access lists
1072 -> static IPv4 routing
1134 -> dynamic routing(ospf)
1175 -> vlan config and disable cdp in two interfaces
1178 -> static routing
1182 -> IPv4&IPv6 subnetting and assign the ips to intefaces
1216 -> static routing
1258 -> configure vlans and lldp/cdp
1260 -> configure vlans and lldp/cdp
1266 -> vlan config & etherchannel(LACP i think)
1285 -> vlan config
1295 -> IPv4&IPv6 subnetting and assign the ips to interfaces
1310 -> vlan configuration && etherchannel

883 -> search tomorrow
995 -> ask teacher
1029 -> ask class?
1018 -> 
1076
1205
1224

_____________________________________________________________________________________________________________________________

Association Response é wireless 802.11 frame? ver no jeremy it labs wireless stuff
FAZER A RECUPERAÇÃO DE SWITCH CONFIG(remover o secret se esquecer-me and shit)
https://www.youtube.com/watch?v=PCpnRqKCWCQ 
!!Terraform -> Programming Language para gerar infrastructure de VPCs de AWS !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!Docker & kubernetes
!!FAZER AWS CERTIFICATES
!Grafana -> Usado para fazer baseline. Usar prometheus com grafana(não sei o que faz tbh lmao)
!Metasploit
!PagerDuty -> emails stuff?
!Wazuh -> Security for the machines

Circleci -> CI/CD thingy
splunk
datadog
lettcode
Ansible -> Automação de instalação de programas e sudo apt updates n shit
Puppet -> same as ansible I believe
Low orbit ion cannon -> dos tool
https://hash-file.online/ <- hashing checksum website
TOR browser
whois.domaintools.com -> 
vulnerability database
kismet (https://www.kismetwireless.net/)
indeed.com -> Procurar trabalho/Estágio
stepstone.com -> Procurar trabalho/Estágio
totaljobs.com -> Procurar trabalho/Estágio
Goteleport -> 
Ostinato -> Hacking tool and stuff
Travis yml -> 
New Relic
teleport
nvd vulnerability
default password lists(routers n shit)
assinar documento digital -> https://www.autenticacao.gov.pt/cmd-assinatura
como verificar uma assinatura digital
chave digital na riac
git lab actions
https://www.manageengine.com/products/netflow/nbar-monitor.html
-------------------------------------------- Termius -----------------------------------------

Connect to Linux Server with Termius:
Settings -> Keychain -> Key(com icon) -> Meter a private key(no awsacademy.instrucutre.com -> AWS Details)
Hosts -> New Host -> Name -> address(public address ipv4 da maquina escolhida) -> Set Key -> Launch

 ------------------------------------------------- STUDY -------------------------------------

----- Emails -----
MUA(Mail User Agent): Dá-se nos pcs dos clientes | Quando o utilizador acede ao seu email(?)
MTA(Mail Transfer Agent): Dá-se no transporte de informação entre emails diferentes(differentes enderessos) | Altera de servidor de envio (ex: maria@enta.pt -> pedro@inva.pt (os enderessos mudam))
MDA(Mail Delivery Agent): Deposita o email na caixa de correio(envia para a 'database' e só quando o utilizador acede ao email é que a informação poderá ser vista e transferida)

(entre emails na mesma rede)       MUA -> MTA -> MDA -> MUA: User1 -> Envia para o enderesso do User1 -> Envia para o servidor de email do User2(que por sua vez está no mesmo servidor que o email do User1) -> User2 acede ao email
(entre emails em redes diferentes) MUA -> MTA -> MTA -> MDA -> MUA: User1 -> Envia para o enderesso do User1 -> Envia para o enderesso do User2 depois de verificar que não estão no mesmo enderesso(servidor) ->   
                                                                               Envia para o servidor de email do User2(que está num enderesso(servidor) diferente do User1) -> User2 acede ao email

--------- Protocols ---------
- Well Known Ports: 0-1023 HTTP, HTTPS, TELLNET, etc...(ports communemente usadas por web servers(sites))
- ICMP: Echo & Echo-Reply | É um protocolo que os dispositivos de uma rede usam para comunicar problemas com a transmissão de dados.
- Network unreachable: No route for the destination network could be found in the routing table on the reporting router
- Service unreachable: A network client (such as a computer or mobile device) is unable to establish a connection to the server
- Host unreachable: The host that you are trying to ping is down or is not operating on the network
- Source quench: Allows the router (or the destination system) to inform the sending device that the network is congested, and to please stop sending so much data.
- TTL: Não é infinito. Quando chega a 0, o pacote vai ou para o dono, ou para o lixo (icmp é opcional) | The amount of time or “hops” that a packet is set to exist inside a network before being discarded by a router
- FTPS: Is an extension of the popular File Transfer Protocol that supports Transport Layer Security (TLS) and the new defunct Secure Sockets Layer (SSL).
- SSH: A method for securely sending commands to a computer over an unsecured network. SSH uses cryptography to authenticate and encrypt connections between devices.
- FTP(porta 20,21): A standard network protocol used for the transfer of files from one host to another over a TCP-based network, such as the Internet. Usa TCP para enviar os packages/envelopes
- TCP: Usa frame check sequence | Acknowlagement/Delayed Acknowlagement | Permite controle de fluxo(Window Size) 
- UDP: Source Port, Destination Port, Length e Check Sum(tcp tambem tem esse quatro campos) (Protocolo mais leve que TCP. Porque ocupa menos espaço no package/envelope)
- TLS: Encrypts data sent over the Internet to ensure that eavesdroppers and hackers are unable to see what you transmit.
- IP: The identifier that allows information to be sent between devices on a network
- Checksum: Protocolo para identificar se a package/envelope tem os mesmos detalhes/credenciais de quando foi enviado(ver Check Sum a baixo) 
- CRC: A method to ensure data has not been altered after being sent through a communication channel | A CRC which is short for a Cyclic Redundancy Code is a powerful type of a checksum
- FCS - Frame Check Sequence: A part of the frame put in place to verify that the information each frame contains is not damaged during transmission
- NTP: An internet protocol used to synchronize with computer clock time sources in a network.
- DHCP(Port 67, 68)(usa só UDP. Para o cliente pedir um IP ao DHCP Server (O cliente não tem IP então não pode usar TCP porque TCP establece comunicação entre os dois, e como o cliente não tem IP não funciona)): É um protocolo de cliente/servidor que fornece endereçamento a maquinas de forma automatica numa rede -> como a máscara, default gateway, IP, DNS...

- Porta 445: usada para partilhar ficheiros | Não pode ser partilhado para a internet.
- Porta 20 & 21: Usadas para transferir informação entre cliente e servidor
- Port 80: HTTP é o protocolo que faz www funcionar
- Port 443: HTTPS é um HTTP mas mais seguro
- Port 53: DNS identifica o IP do site introduzido pelo utilizador ou vice-versa
- Port 3389: RDP usado para aceder a uma maquina remotamente 
- Port 3390: 
- 127.0.0.1(Localhost & LoopBack). Todos os computadores têm o mesmo localhost IP, podendo ser acedido apenas pelo proprio pc. Ou seja, nenhum pc ou rede externa consegue aceder ao meu localhost IP
- 192.0. 2.0/24 - This block is assigned as "TEST-NET" for use in documentation and example code

--------  --------
- DHCP -> Discover, Offer, Request(Formalização), ACKNOWLAGE/NACK
    - Triple way handshake: SYN, SYN-ACK, ACK | Positive acknowlagement receit(PAR)
 
 - OUI(Organizational Unique Identifier): The part of the MAC address that identifies the vendor(fornecedor) of the network adapter(os 3 primeiros bytes (em hexadecimal))

 - ADSL: asimetrico - mais download menos upload ou vice versa
 - SDSL: simetrico - mesmo download e upload
 - XDSL: custom - download e upload costumizavel

Fontes de informação para criar a tabela de roteamento do router: O que o Router sabe, O que o administrador disse, o que os outros Routers disseram(Routing protocols)
   - RIP: Metric para escolher a rota é o "hop count" | Max de 15 hops | hop 16 é uma msg de hop limit reached
   - EIGRP: By default uses bandwidth and delay values to choose the route | 
   - OSPF: Uses "cost" as a metric which is based on the cumulative bandwidth from source to destination
   - Static route


- Bandwidth: The capacity at which a network can transmit data.
- Throughput: The amount of information a system can process in a given amount of time, measured in bits, bytes, or data packets per second
- Goodput: Measures how fast and accurately useful data travels the network and arrives at its desired location

RoutED protocols:
RoutING protocols: encapsulam dados relativamente a rotas -> EIGRP, RIP, OSPF...?não sei se é o de cima.

access list standard - defesa no ultimo momento possivel | 1-99
access list extended - defesa no primeiro momento possivel | 100-199

Pairity Bit: 0 para par | 1 para impar | 00101000 0 -> aceita | 11010000 0 -> não aceita

startup config tá na nvram e é loaded na ram on boot(depois é transformada em running config acho eu?)
iso está no flash e é loaded na ram on boot
Running Cnfig está na ram | é implementado pelo IOS | é guardado no nvram em caso do device se apagar de repente

Application - HTTP, HTTPS, DNS, SMTP, IMAP, POP3, FTP, SSH, TELNET, DHCP, SNMP:
   DHCP: UDP(servidor: 67 | cliente: 68)
   TELNET: Coneção de telnet não é encriptada
   SSH: TCP, é o mesmo que TELNET mas os dados estão encriptados(acesso remoto encriptado | porta: 22)
   FTP: Serve para transferir ficheiros(porta: 20(ftp data: response) - transferencia de dados | 21(ftp control: request) - request de dados)

         |Clear| SSL |StartTLS
    SMTP | 25  | 465 | 587 -> smtp recebe o email do cliente e se for do seu servidor(ex: @enta.pt) guarda-o na sua storage. Se for de outro servidor de email(ex: @inova.com) manda-o para esse servidor e esse servidor(inova) guarda-o na sua storage se for seu.
    POP3 | 110 | 995 | 110
    IMAP | 143 | 993 | 143

   SNMP(Simple network managemente protocol): UDP(portas: 161, 162), Serve para o equipamento de rede dizer tudo ao servidor
   TFTP(UDP port 69): back up para um router(sort of)

Spanning tree protocol: evita que haja loops infinitos na camada 2(switch layer)

HSRP: Num caso em que existem duas ligações para 2 routers diferentes a partir de um cliente, este protocolo escolhe um dos dois
VRRP: Num caso em que existem duas ligações para 2 routers diferentes a partir de um cliente, este protocolo escolhe um dos dois
GLBP: load balance | estando ambas as ligações a ser utilizadas, usa as duas. Se uma falhar, vai pela outra ligação.

IDS: detetar intrusão | faz copias dos packets e alerta 
IPS: prevenir a intrusão | os packets param no ips, logo é mais lento, interrompe o fluxo de dados

Boot Field(default é 0x2102):
 0000 -> Rom monitor
 0010 -> Flash
 0001 -> Verifica a config para ver se o administrador o configurou

 FHRP: Protects the default gateway used on a subnetwork by allowing two or more routers to provide backup for that address
 GLBP: Protects data traffic from a failed router or circuit | provides virtual Mac addresses to all the other routers operating GLBP of the same group
       The remaining routers are Actual Virtual Forwarder (AVF). When an ARP request comes from subnet device to know the Mac address of the virtual IP address,
       one of the virtual Mac addresses is provided by the AVG.
       AVG(Actual Virtual Forwarder): These are actually responsible for forwarding the data after they are assigned by the AVG for the task.
				      If in case AVG goes down, one of the AVFs can become the AVG.

DMZ: A physical or logical subnet that separates a local area network (LAN) from other untrusted networks
Wildcard: 255.255.255.255 - mask(xxx.xxx.xxx.xxx): A mask of bits that indicates which parts of an IP address are available for examination
GRE: Protocol for encapsulating data packets that use one routing protocol inside the packets of another protocol

RFC1918: Gama de IPs privados(10.0.0.0, 172.16.0.0, 192.168.0.0)
IPs especiais:
  0.0.0.0
  127.0.0.0/8 -> Localhost ou Loopback
  169.254.0.0/16 -> APIPA
  192.0.2.0/24 -> 

Switch:
  Em trunk links(marca as vlans enquanto enviam pacotes and shit)
     VLAN1: É sempre a default vlan (default = 1)
     Native: Essa vlan não vai marcada. Quando passa por um trunk link, ela não vai marcada, ao contrario das outras que estão marcadas com o numero da vlan(ex: preto mac dest, mac origem | vermelho mac dest, mac origem, vlan 1)
   
  Em Access Link:
     

Trunk Port: Carries traffic between switches and maintains the VLAN information | Num trunk link, todas as vlans passam(dentro do bradcast domain) | Agregates the connections for a spechific port/connections
  - Usa 802.1Q

 HDLC: A group of protocols or rules for transmitting data between network points | é usado por default só em routers da cisco | é usado para comunicar(layer1 encoding i think) entre dois routers numa coneção 

Routed Protocol:
Routing Protocl:

ISN(Inicial sequence number): É relativo | Determinado no establecimento da sessão(no triple way handshake)
Window Size: Quantidade de bytes que um cliente consegue receber até ao servidor perguntar se recebeu(o cliente envia a sua window size no establecimento da coneção(triple way handshake))
Congestion Window Reduced(CWR):
CI/CD: A software development approach that aims to improve the speed, efficiency, and reliability of software delivery.
MAC: utilizado apenas numa rede local(?)
Access Layer: 
Distibution Layer: 
Core Layer: 
Ether Channel: 
Breach Table:
CAM Table:
Dominio de colisão: todas as pernas do router são colisões, todas as pernas dos switches são dominios de colisão
Switch e Breach(Camada 2)
Broadcast está delimitado pela camada 3
Reverse ARP: Tenho o MAC e quero o IP
Até onde chega a eletricidade?: Chega á colisão
Dominio de broadcast: Dá-se quando um broadcast é enviado pela network e para no router (ex: 7.4.1ou2)
Line Coding:  
  - 4B5B encoding: Frequencia em que a informação é enviada(a velocidade é a mesma não imiporta o que, porque o tamanho do cabo é o mesmo) | 100BASE-T
  - 8B10B encoding(quando a velocidade aumenta): Frequencia em que a informação é enviada(a velocidade é a mesma não imiporta o que, porque o tamanho do cabo é o mesmo) | 1000BASE-TX

Recursive Lookup: Quando não recebe a porta e sim um IP na routing table, olha para a routing table outravez para descobrir a porta da gama de IPs do IP dado        
Dynamic Routing: É usado para definir a melhor rota para o router usar para enviar informação(frames) para o IP/Maquina de destino. ex: OSPF ad de 110, IGRP ad de 100. O path vai usar IGRP
   AD(Administrative Distance):
      C(Diretamente conectado) -> 0
      S(Static Route) -> 1
      EIGRP Sumarizada(AD de 5):
      BGP External(AD de 20):
      EIGRP(AD de 90): Bandwith, Occupation, Jumbs between devices to reach the destination, ..., ..., ... | Broadcast(? não sei se é igrp ou eigrp)
      IGRP(AD de 100): 
      OSPF(AD de 110): usa o multicast address 224.0.0.5 para comunicação normal e 224.0.0.6 para dar update a um router designado
      IS-IS(AD de 115):
      RIP(AD de 120): Não usa VLSM(se R1-172.16.0.0/24 fizer conecção com o R2-192.168.0.0/26, a mask que vai dar assign é /16 porque RIP é classfull, não usando VLSM) | Broadcast
      EIGRP Exterior(AD de 170):
      BGP Interior(AD de 200):

Processo que o router usa para receber um frame:
   Ao receber o frame, descapsula o MAC(enderesso fisico), procura pelo IP na tabela de roteamento, Encapsula outravez tendo em conta o protocolo(OSPF, BGP, IGRP...) que a interface/porta usa

Load Balance: Method of distributing network traffic equally across a pool of resources that support an application | Se todas as rotas são iguais(ex: 3 rotas de OSPF), distribui igualmente
														     | Mas se forem todas RIP, escolhe a melhor entre elas(ex: escolhe 120/10000 em vez de 120/999999)

- FQDN(Fully Qualified domain name): A domain name that specifies its exact location in the tree hierarchy of the DNS.
                                     It specifies all domain levels, including the top-level domain and the root zone
  				      
Registo tipo A: (A) Type records are used to resolve a hostname which corresponds to an IPv4 address, while (AAAA) records are used to resolve a domain name which corresponds to an IPv6 address
Registo tipo CNAME: A type of DNS record that maps an alias name to a true or canonical domain name. Dá um nome(ex: www) a um ficheiro que tem o site incluido(ex: central.pt). Junta os dois no final
																						  (www.central.pt)
Registo tipo NS(Name Server -> DNS): Identifica um servidor de DNS(?) | An identifier within a DNS zone that tells it which Name Servers (which are your DNS servers) to use as the authorities for that zone.
Registo tipo MX(Mail Exchange): MX record is a special type of DNS record that serves for the sole purpose of email communication
SMTP(Simple mail transport protocol): The service that controls how your emails move across networks
 

Nat-Gateway: You can use a NAT gateway so that instances in a private subnet can connect to services outside your VPC but external services cannot initiate a connection with those instances.
Static NAT: Mapeamento de um IP para um IP (a maquina tem um ip dentro da rede, mas fora da rede tem um diferente. Sempre que um packet passar )
Dynamic NAT: Envolve um determinado numero de IPs publicos para um determinado numero de IPs privados. 
             Quando alguma maquina(IP privado) acede á internet, Dynamic NAT atribui um ip publico a essa maquina
PAT: Para alem de traduzir o network address(TCP/IP 3ªcamada ou OSI), vai traduzir a porta se for preciso. 
     (quando duas maquinas numa rede acedem ao mesmo port, muda o port da segunda maquina
      exemplo: Maquina1 acede á porta 5000, maquina dois tambem, muda a porta da maquina2
      para 5001 para poder aceder ao server que usa essa port ao mesmo tempo).

Root bridge:
  BID(Bridge ID):
-----------------------------
Major-N etwork: /8, /16, /24
Super-Network: /<8, /<16, /<24 | Super rede é sempre uma sumarização
Sub-Net: />8, />16, />24
Conecção entre routers diferentes: Connected or not, Static Route(Administrator), Dynamic Protocol

 ----------------------------------------------- CMD e Wireshark Commands ---------------------------------------

 Alterar a pass do windows (powershell):
    - $Secure_String_Pwd = ConvertTo-SecureString "Passw0rd" -AsPlainText -Force
    - Set-LocalUser administrator -Password $Secure_String_Pwd

 Wireshark:
    - Filtrar:
        - udp.port == (port | ex:53) (port de destino(ex: De www.azores.com é 53)) <- 53 é o DNS, então não sei porque a porta é essa. Talvez porque metemos um nome(www.azores.com) e recebemos um IP 
 	- tcp.port == (ex: 433)
	- ip.addr == (ip) (usar ip.addr para verificar se os ficheiros de firezila estão encriptados)
        - icmp -> usado para identificar pings de outras redes/maquinas (ex: os pings do exercicio 15 do professor)
	

    - ssh -i labuser.pem ubuntu@(linux ip) | ex: ssh -i labsuser.pem ubuntu@54.165.131.15 (tenho que estar no diretorio(pasta) onde a labsuser.pem está) 
    - chmod 400 (file name) (muda as permissions?)



------------------------------------------------- IPS e Binário --------------------------------------

 | 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
 |  0  |  0 |  0 |  0 | 0 | 0 | 0 | 0 | -> 0 == 0 bits
 |  1  |  1 |  1 |  0 | 0 | 0 | 0 | 0 | -> 224 == 3 bits
 |  1  |  1 |  1 |  1 | 0 | 0 | 0 | 0 | -> 240 == 4 bits
 |  1  |  1 |  1 |  1 | 1 | 1 | 0 | 0 | -> 252 == 6 bits
 |  1  |  1 |  0 |  0 | 0 | 0 | 0 | 0 | -> 192 == 2 bits

  
 !255 -> 1 byte -> 8 bits 
 !Ver exemplo da tabela acima para clarificação:
 /16 255.255.0.0 (16 bits -> 255 == 8 bits)
 /19 255.255.224.0 (19 bits -> 224 == 3 bits)
 /20 255.255.240.0 (20 bits -> 240 == 4 bits) 
 /6  252.0.0.0 (6 bits -> 252 == 6 bits)
 /26 255.255.255.192 (2bits -> 192 == 2bits)
 !Masks determinam qual é o tamanho da rede e quantas maquinas essa rede pode ter

 Identificação da rede e maquina: 
 Original: 192.168.5.8
 Rede: 192.168.5.0 (0 para a rede inteira)
 Maquina(pc): 192.168.5.8 (IP inteiro para identificar a maquina)

 /8 -> 24 bits para identificar uma maquina
 /16 -> 16 bits para identificar uma maquina
 /30 -> 2 bits para identificar uma maquina
 ...

 ---------------------------------------
 Verificar se os IPs são da mesma rede:

 Aqui, verifica-se que os dois primeiros IPs são da mesma rede, no entanto, o terceiro é de outra rede, pois os 2 bits são '11', e não '10'
 192.168.5.140/26    140 = (10)001100 y
 192.168.5.160/26    160 = (10)100000 y
 192.168.5.193/26    193 = (11)000001 n

 Para clarificação final. Se a mask fosse /28, então, nós teriamos 28 bits ativos e 4 bits inativos para poder identificar se os IPs são da mesma rede,
 então desta vez teremos que verificar se os ultimos 4 bits(dos 28 bits inativos) são iguais:
 11000000 10101000 00000101 (1000) | 1100 

 -------------------------------------
 Classes de IPs:
 A 0     | /8 ==  255.0.0.0 (8 bits 'ligados')
 B 10    | /16 == 255.255.0.0 (16 bits 'ligados') 
 C 110   | /24 == 255.255.255.0 (24 bits 'ligados')
 D 1110  | Nunca vou encontrar esta classe n shit | Nunca pode ser um remetente, só pode ser um destinatário
 E 1111  | Exclusivo de uns manés

 --------------------------------------
 Determinar a classe de um IP:
 Calcular o primeiro Byte(8 bits) de um IP(converter para binário)
 Exemplo: 172.16.0.1
 	  172- 10101100 -> começa com 10, logo é classe B

 Exemplo2: 192.168.0.1
	   192- 11000000 -> começa com 110, logo é classe C

---------------------------------------
Calcular o numero de Maquinas que uma rede pode ter:
 32(numero total possível) - N(numero da mask ex: /8, /29, /30...)
 2^x(total da conta anteriror) - 2(primeiro e ultimo (000 e 111))

------------------------------------------------ Volumes ---------------------------------------------------------------------------------------

Simple volume -> volume normal, pode-se acossiar automaticamente a uma letra (ex:'C') ou um folder criado por mim proprio
Spanned volume -> adicionar 2 ou mais volumes e junta-os num só
Mirrored volume -> menos desempenho,(escreve em dois lugares(mirroring))
Raid5 -> With a RAID 5 array using three or more drives, data and parity are striped across all the drives. Data is processed on two drives while the third drive holds the parity information.

Tutorial para conectar-se a uma maquina aws por windows:
https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/connecting_to_windows_instance.html

AWS minha guide (Instancias, VPC, Volumes, (adicionar xampp), partilha de pastas...)
https://docs.google.com/document/d/1EMsQvCH4CX_hS7qlD2RiD_tbtx1wGp8W/edit

------------------------------------------- Teste de DNS, Sites(IIS), FTP, User Management, VPC, Routing and Remote Access -----------------------------------------------

 Aplicações:
    - Server Manager
    - Power Shell
    - CMD
    - https://docs.google.com/document/d/1Ka1fgUXJQ6Sk6krxNvmB9CZHv_leKU1W_HCGRHebTBg/edit#heading=h.cdb5rberw5mr


AWS: 
   Criar uma default VPC
   Criar uma nova subnet na mesma availability zone que a east-1a(ou o que o prof escolher) e dar um nome(ex: windows11-network). Nomear a network já existente de default para saber qual é(ex: default east-1a)
   Ir ao default security group e adicionar -> All Trafic para MY IP e para a gama de ips da VPC(ex: 172.31.0.0/16)
   Criar o Windows Server na subnet default(east-1a) a e meter Auto-assign public IP disabled

   Na Network Interface 1 -> colocar um IP no Primary IP que esteja na mesma gama de IPs que a default east-1a(ex: 172.31.16.100). Este vai ser o IP usado pelo WinServer para dar internet aos windows11
   Adicionar uma nova Network Interface e colocar um IP no Primary IP(ex: 172.31.96.100 | Este IP é relacionado á subnet criada -> windows-network)
   Escolher a subnet windows-network como Subnet(subnet criada por mim)
      ! Subnet windows-network(.96) é a private network usada pelos windows11 | Subnet default east-1a(.16) é a private network usada pelo windows Server para permitir aos windows11’s acesso á internet
  
   Criar um Elastic IP e associar á Network Interface default east-1a do Windows Server (ex: 172.31.16.0/20)
   Selecionar o Windows Server -> actions -> Networking -> Change Source/Destination Check -> Stop(é para marcar)


1 Instalar Active Directory Domain Services
  Promover a Domain and shit


2 Alterar o nome dos WinServer:
    This PC -> Propriedades -> Alterar o nome -> Reiniciar


2.1 Criar o Windows11 A e B(usar AMI do prof):
    Escolher a subnet 'windows-network', a que foi criada por mim(172.31.96.0/20)
    Escolher o default security group


2.2 Promote Server to Domain Controller:
    Add new forest -> ciber.com -> Pass: Passw0rd -> next em tudo e Install. O Win Server vai fechar, abre algum tempo depois.


2.3 Remote connection para entrar no Windows11 A com ec2-user(No Windows Server):
    Usar o IP privado do win11 A

2.6 Alterar o nome dos Windows11:
    This PC -> Propriedades -> Alterar o nome -> Reiniciar

2.7 Instalar o servidor de DHCP, Remote Access e Web Server IIS no Server Manager:
     FTP Server -> Next -> Routing -> Next -> Install
     Complete DHCP configuration -> next -> commit

2.8 (WINDOWS SERVER) Alterar o IP fixo, Subnet mask, Default gateway(no IPv4):
     - Placa 1:
        - IP, Subnet mak e Default gateway
     - Placa 2(ip maior normalmente):
        - IP e Subnet mask. (deixar default gateway em branco)
     Mudar o IP das Network Interfaces do Windows Server:
       Alterar o IPv4 da Network 3 e 4 tendo em conta o que diz no CMD(ipconfig /all)

2.9 Adicionar as maquinas ao Dominio(ex: ciber.com):
     - Propriedades de This PC -> Advanced settings -> Change -> ciber.com


3 configuração de DHCP server(Windows Server):
       Botão direito em IPv4 -> New Scope -> Nome qualquer(ex: Windows Private Network) -> Start e End IP addr são á nossa escolha (ex:172.31.96.128 - 172.31.96.191) ->
       mask á escolha(ex: /20 ou 255.255.240.0) -> next -> next -> next -> Private IP do Elastic IP do Windows Server(Dar ADD) -> next.....

3.5 Alterar IP fixo do windows11 A:
    Ir ao IPv4(advanced network settings) -> Propriedades -> IPv4:
       - IP address -> 172.31.96.101 | O IP vai ser igual(ultimo byte é 101 em vez de 100) ao Private IP address da network interface do windows-network(dar nomes ás network interfaces.
         Posso ver qual é qual pela subnet associada)
       - Subnet Mask -> Depende da mask da subnet usada()
       - Default Gateway -> É o IP privado do Elastic IP do WinServer. É este IP que server de Rooter para os windows11's acederem á net
       - Preferred DNS server -> 172.31.96.100 (IP Elastico do WinServer para ser usado como DNS server)
     Ao finalizar, vou perder a conecção, tentar conecção depois de dar stop e start á maquina no AWS, com o IP fixo que foi dado(ex: 172.31.96.101)
usei: 172.31.121.101 | 255.255.255.0 | 172.31.16.100 | 172.31.121.100

4 Criar pastas root para os sites NO WINDOWS SERVER:
     - Disco C:/ -> Criar novas pastas dentro do disco C com nomes tipo: oriental.pt, central.pt... (NÃO INCLUIR WWW)
     - Criar ficheiros ex: index.html e escrever alguma coisa dentro

 4.5 Criar sites (IIS) NO WINDOWS SERVER:
    IIS Manager:
      - Botão direito em sites -> Add Website -> Colocar o www.site.pt no 'site name' e 'host name'. Escolher os physical path

 5 Criação de Certificado:
    Selecionar o servidor(2ª opção):
        Self-Signed Certificate:
            - nome tipo: www.oriental.pt
	    - Web Hosting

 6 Associar um Certificado a um site:
    - Escolher um site -> Bindings -> Add -> escolher https -> hostname(ex: www.central.pt) -> SSL Certificate: escolhe o certificado criado

 7 Criar um site FTP(OPCIONAL?):
   - Botão direito em sites -> Add FTP site -> ex: www.oriental.pt e physical path(pasta no disco C:/) -> Enable Virtual Host Name: www.oriental.pt | No SSL -> Basic -> Allow Access to all users ->
     Permissions necessárias -> Finish
   - (Useless I think)Podemos também adicionar uma binding de ftp a um site já existente.

  8 Criar Groupos e Utilizadores:
    Active directory users and computers:
       - Em ciber.com(2ª pasta) -> botão direito -> new Organizational Unit
            - Dentro da Organizational Unit:
                 - Criar grupos com o nome desejado 
                    - Criar utilizadores e acossia-los aos seus respectivos grupos

  8.5 Manage IP addresses no AWS(para aceder às maquinas com o IP fixo que foi introduzido no ponto 2.8):
    Escolher um dos windows11 -> actions -> Networking -> Manage IP addresses -> Expandir a network interface -> Assign new IP address(ex: 172.31.96.101 <- IP fixo que demos assign anteriormente) -> Save

  8.6 Conectar ao Windows11-A a partir do Windows Server usando o novo IP(ex: 172.31.96.101):
    Se não funcionar, verifica se no IPv4 o IP, default gateway ou DNS fixo estão corretos.
    Verificar se no AWS, o Change Source/Destination Check tem o 'Stop' marcado.

  9 Alterar o dominio do Windows 11:
      - Ir a propriedades de 'Este PC' -> Domain or Workgroup -> Change -> Domain: ciber.com(o nome do servidor DNS está no DNS de Server Manager do Windows Server)
      - Se der erro é porque a maquina não está a usar o DNS do Windows Server(Ir ao IPv4 e alterar para o IP privado do Win Server).


  10 Para entrar na maquina com remmina e contas diferentes(ex: maria):
       Dentro do windows11(usando ec2-user remotamente a partir do Windows Server):
          Propriedades de 'This PC'  -> Domain or Workgroup -> Remote -> Add -> nome do utilizador -> Usar Administrator - Passw0rd -> Restart -> Editar as credenciais na remmina(só o user) -> entrar 

  ! Se as maquinas estão em availability zones diferentes, o processo é o mesmo, apenas temos que criar uma inbound rule no windows server para o windows11 poder aceder e pingar o Windows Server(acho eu)

   11 Roaming Profiles:
        (NO WINDOWS SERVER)
        Criar uma pasta no disco C:\ -> propriedades -> Share com todos -> Copiar o Network Path(ex: \\EC2AMAZ-0DRURUB\utilizadores\):
           Active Directory Users and Computers -> Pasta dos users:
              - Propriedades do user -> profile -> Colar o network path no Profile path \\EC2AMAZ-0DRURUB\utilizadores\%username%\Profile e no Connect: \\EC2AMAZ-0DRURUB\utilizadores\%username%

  12 Instalar WireShark no Windows Server:
     Wireshark vai ser usado para verificar se os windows11 estão a tentar comunicar com o windows server para aceder a sites
     Usar ip.addr = (ip que o cliente está a pingar) para verificar se os pings estão a ser direcionados ao windows server
     Abrir Ethernet 3 e 4 ao mesmo tempo para ver os pings todos!

  
  13 Routing and Remote Access(permitir os windows11 acederem á net)(tools):
     Botão direito no WINSRV(local) -> Configure and Enable... -> Custom Configuration -> NAT & LAN Routing -> Start Service
     Abrir o WINSRV(local) -> Abrir IPv4 -> no NAT, botão direito -> New Interface -> Adicionar uma de cada vez(apenas a 3 e 4)
     NETWORK INTERFACE 3 -> Subnet Default(ex: 172.31.16.0) <- IPv4          | Public Interface e Enable NAT
     NETWORK INTERFACE 4 -> Subnet criada por mim(ex: 172.31.96.100) <- IPv4 | Private Interface

     Se a public interface(network interface 3) não tem nenhum mapping, então o problema deve ser da cena do aws -> change source/destination check -> tem que tar stopped(marcado),
     Se não for esse o problema, vê se o IP, Default Gateway e DNS estão certos no Windows11-A

     13.1 Usar portas 3390 e 3391 para os windows11 acederem á net(NO WINDOWS SERVER):
	     1 - (RDP para WIN11A)Ir ao Routing and Remote Access -> NAT -> botão direito no Ethernet3() -> Proprieties -> Services and Ports -> Add -> Descrição que eu queira(RDPwin11A) ->  
		 Incoming Port: 3390 -> Private Address: é o IP fixo do windows11 A(ex: 172.31.96.101) -> Outgoing Port: 3389
             2 - (RDP para WIN11B)Ainda no Ethernet 3 -> Propriedades -> Services and Ports -> Add -> ex: RDPwin11B -> Incoming Port: 3391 -> Private Address: É o IP fixo do Windows11B(ex: 172.31.96.102)
                 -> Outgoing Port: 3389
 	     3 - Ir ao remmina e colocar o IP publico do Windows Server com a porta á frente(ex: 54.213.32.124:3390 e 54.213.32.124:3391)

  14 DNS: 
     Forward Lookup Zone:
     - Botão direito -> new zone -> nome do site(ex: oriental.pt (sem www)) -> next...
     - Ao criar um ficheiro Type (A), usar o IP privado da Ethernet 4(subnet criada por mim(windows-network))(ex: 172.31.96.100) <- IP do windows server que dá 'host' aos sites e windows11

     - Criar um ficheiro do Typo (A) para referenciar a um IP (!NOTA: é necessário ativar a reverse lookup zone para poder escolher a opção -> "Create associated pointer (PTR) record")
       PTR é usado para introduzir o nome do site e receber o seu respectivo IP
     - Registo tipo CNAME para associar a um ficheiro Tipo (A) | Isso só se faz quando o ficheiro Type(A) não tem www no primeiro campo(FQND não tem www no inicio)
     - Registo tipo MX: Nome de Host(opcional) -> FQDN: escolher um ficheiro dentro da pasta root de um site(tipo A só acho eu)
    Reverse Loopup Zone:
     - Criar uma nova zona -> next sempre -> Introduzir o IP privado até ao 3ºbyte(no Network ID, ex: 172.31.47)
     - Ao criar um novo PTR: Introduzir o Private IP address e encontrar a pasta root do site(criada no disco C:/) escolhendo o ficheiro do tipo (A) | Isto é também usado para criar stmp(mail system)


 !!!(Se não foi feito antes no ponto 10)Aceder remotamente ao Windows11-A a partir da maquina original (IP ex: 172.31.96.101) PARA PERMITIR ACESSO A NOVOS USERS


----------------------------------------------------- PACKET TRACER BASIC CONFIGURATION --------------------------
Router:

conf terminal
hostname "name"
enable secret "pass"
service password-encryption
banner motd "banner"
security passwords min-length 10
login block-for "seconds" attempts "nº attempts" within "seconds"

no ip domain-lookup
ip domain-name "name"
crypto key generate rsa
1024

ip ssh version 2
ip ssh time-out 0-120
username "user" secret "secret"

line console 0
password "pass"
login local or login
logging synchronous
exec-timeout 60
exit

line vty 0 4
password "pass"
transport input ssh
login local or login
logging synchronous
exec-timeout 60
exit

line aux 0
password "pass"
login local or login
logging synchronous
exec-timeout 60
exit

interface g0/0
description "description"
ip address "ip" "mask"
ipv6 address "ipv6"
ipv6 address fe80::1 link-local
no shutdown

interface g0/1
description "description"
ip address "ip" "mask"
ipv6 address "ipv6"
ipv6 address fe80::1 link-local
no shutdown

ipv6 unicast-routing
do wr

------------------------------------------
Switch:
conf terminal
enable secret "pass"
service password-encryption
banner motd "banner"
no ip domain-lookup

line console 0
password "pass"
login
logging synchronous
exec-timeout 60
exit

line vty 0 15
password "pass"
login
logging synchronous
exec-timeout 60
exit

interface vlan 1
ip address "ip" "mask"
no shutdown

ip default-gateway "router ip"

do wr



Linux controller with terraform&ansible to create machines in AWS(tudo no terraform_controller):

sudo apt update && sudo apt upgrade -y
sudo apt install net-tools

install terraform
install ansible
install aws cli : https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html

aws configure(only enter the values. the values change with account)
	- aws_access_key_id:ASIAU6GDWVFN6OXR4QX7
	- aws_secret_access_key=M13hLiG21mrS5ValHbSf6us/ztMeqabVou+0QLKH
	
sudo apt install zip
cd .aws/
nano credentials
	-aws_session_token=FwoGZXIvYXdzEDsaDD5yheaveKPBeoZEYCK+AZCLG7svfrZVUv4YS/JkVATusAc76nLoephNjWYAI/igXnTDEciyunJSF0ORDoP4YA20ZGxct8sv9OC7E7V0+tkqTk2JCqjvXYMeOFctLKTC7NBVzXSCVn7HQOy4mo2XKga155X4PPA4lDTjkljkyCCVQXw0niihidwcI80sMnhDZpwJpCw83F71HZFvDtITVm6rNde5LLvv2gCCEsRaxzBkU2pqXeF8gUkjoFv4AheIeyK2Bvg3dYIxOPrfw8Qo/sHMrgYyLf8iSWa5epeDz0uc/u5PMXfU2CRlCFDTxT7HCcCj7HMS1HzSYwXTGI1cUMJX0g==

mkdir terraform
cd terraform
nano provider.tf -> meter as credentials do aws como está no existente(isso liga o terraform á tua aws)

.nano main.tf

terrafrom plan(o que vai fazer quando correr)
terraform apply -> yes (isso vai criar a instance baseada no terraform plan)


ansible -----

nano hosts:
 [servers]
 server1 ansible_host=172.31.7.65
 server2 ansible_host=172.31.0.30
 server3 ansible_host=172.31.2.72
 server4 ansible_host=172.31.3.74
 server5 ansible_host=172.31.8.223
 server6 ansible_host=172.31.1.129


nano ansible.cfg                                                                                            
 [defaults]
 private_key_file = terraform.pem
 ansible_user=ubuntu

 [ssh_connection]
 ssh_args = -o StrictHostKeyChecking=no


nano terraform.pem
 -----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAmALE8AYZnahH7E3k1SNqwLxVEMIKPuinkMN83N9HmRHPGl1V
WfHkylGBPuzD5PsmMj2lde1tfSYQRqyVPKbTNt8DdTeitrZS9hSgh++Mge6tw2Bu
U3ZS5Nxm+jjT4ODIL02k1j+NRmd3aqu+kgqBpg+9IFW77RbIfs1TPECVOhEyA63j
Mk3rS9daKF0DAyrLevhrd5WA2MzU/lMU5AcgoGzHDKEnI8g0N5rf09bPBJ8zDlbj
vcMgq5U5yg60qAEnDRL+zSol24SgRa6I7r4rFIfsqQ1miyvBF2hLqme8aXVdRjbc
RESut7jZiRzS/ougbAnNwbNxbvmkEh6V89m/BQIDAQABAoIBAAGg1fc0OYYEzXBs
jSzzSityWP7q9S0jVNgqH+ZFxgCPvkYsBcQG4UqBgP7pjlefkRMssd8Hggq7I6V+
J8MUjmKiFOlmhSmr3kuggO+z0y95HQdguw3N0Kl+6uN3RF2+SqanEELzP1InvZG4
8TujPSxIMuBryq2JdvBUxrV4g6Cxljt3tPH9AWnanSXp3m1bkIWNyFy203OAMpGh
Oeo98Yye93rKg4Ui0/w5q748rKTdw2pGcM1+qpdMdDOGytQk5xRy85k1P6t0xxae
Ay0tZ5DJ7oGJL6ANYWwjSAKlixBJs2emPTx/A6JQJWDUAHe7x+Niz5mtR9ylR1D3
qDlgNcECgYEAyRwDweoLUo/E3qITh+fVVzZuUv2dFP9GY9yHQIrTb9uZICionvwR
LPLsmkAJ76Es94XmGd7L9Tnfs2S17CkJVigHPMcLyyz5fhI6VVYuSP1sl/WhZjNm
Qi6f+4944eYGX3kJ2X8esyIQwHD3MjXUXHYpHAGCduVzaOz4Kw+qXk0CgYEAwYAe
rLLDLe/Yf7VS1o6Sw1vEeUxRV08T6M65wwnBQm6TbtG9V2qwDi13lRwJFkG/cMLX
O6wa4FWc6N1TjFkj3BJA+5V9lAsB0XbhrbEl23SlbybFSY4bBUjMoowk7kRuX8VI
ZybKCa/+RfVdUKcTTQQ1qwI9i7QjyIxcrxK0b5kCgYB5+nn09cXkT7sy5c8+0Ui+
2w7TW2wZPjQtgaavaQSRhfo8XSzZMT4hqz4C2PCt3W5uu1IzQsUmefHK1zzYfpNh
JGovXPM0SpUQ+HFVLS5pqvxgtuUsHeTaI3l5lS3WpjQbWEi3GLlAIVtTvbDRTYD+
i9SnXesJvmXfsEtdouTMyQKBgQC1jfO6EESHrnoRYV1nSQC1Yj4XnZ7Yb677ijPL
pzR4k22r1gl0ovqrYsfH1TVFd80bDQWLzLCu+kUuTLQehGjcDRiBtcLNDALZuVSI
dyVRIsIyZ0tG95msvKCchygDk5uIKoADoOaCbmoC0/SJPyoh4ihE2uZKVWwZuHEi
J0e7SQKBgEkNaC7q1z0kFcZxWhQQGgzChbzTorA0lH1cztya3AEgNrbd6ajg+gUe
+QMg8GHTPILnCjIiKNgFSzxYiyoy12lvRngbbOFLHxebqHYiHgPfJhHhVnHh3XsL
aDkJyA2BK8hGhzVqLmymPag1lMPB5CdSVCtNisjd6pGToCcAdoaE
-----END RSA PRIVATE KEY-----


nano update_all.yml                                                                                        
---
- name: Update packages and reboot if a new kernel is installed
  hosts: servers
  become: true
  tasks:
    - name: Update package cache
      apt:
        update_cache: yes

    - name: Upgrade all packages
      apt:
        upgrade: dist

    - name: Check if a new kernel is installed
      shell: dpkg-query -W -f='${db:Status-Status}\n' linux-image-$(uname -r) | grep -qE '^install'
      register: new_kernel_installed
      changed_when: new_kernel_installed.stdout == 'install'

    - name: Reboot if a new kernel is installed
      reboot:
        reboot_timeout: 600
      when: new_kernel_installed.changed



ansible all -i hosts -m ping (to ping all hosts in the 'hosts' file | the hosts file can't have white spaces around the '=')

nano print_hostname.yml -> meter o que está lá
ansible-playbook -i hosts print_hostname.yml
ansible-playbook -i hosts update_all.yml

